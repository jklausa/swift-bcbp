# swift-bcbp

A Swift-y printer-parser for BCBP (Bar Coded Boarding Pass) format.

Most other packages usually only support _parsing_ the format, this one explicitly also supports _creating_ the BCBP data.

## Status

Based on my personal (300+) collection of boarding passes, which should be plenty of test data; in addition to the reference of the BCBP implementation guide.

## Test data

The test data is private for semi-obvious privacy reasons, but it is generated by the following shell script:
```bash
find . -name "pass.json" -exec jq -r '
    select(
        has("boardingPass")
        and .passTypeIdentifier != "pass.com.deutschebahn.navigator"
        and ((.barcodes[0].message // .barcode.message) != null and (.barcodes[0].message // .barcode.message) != "")
    )
    | input_filename + ": " + (.barcodes[0].message // .barcode.message)
    ' {} \;
```

On a Mac, a copy of the boarding passes is stored in `~/Library/Mobile Documents/com~apple~shoebox/UbiquitousCards`.
There are also files in `~/Library/Passes/Cards`. 

The sets, on my Mac, at least, are mostly the same, with a couple of passes appearing in one but not the other.

Someone who has more hunger for reverse engineering the system frameworks might be able to find out what the difference between the two is.

Based on your particular collection, you might need to massage the `jq` invocation somewhat â€” as you can see, I needed to filter out the Deutsche Bahn passes, which are not BCBP compliant. If your collection contains any similar weirdness from different vendors, you might need to ignore these too.
